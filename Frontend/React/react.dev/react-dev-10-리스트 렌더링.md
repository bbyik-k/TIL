# React.dev-docs-10-리스트 렌더링

[REACT 학습하기 > UI 표현하기 > 리스트 렌더링](https://ko.react.dev/learn/rendering-lists)

## Goal

- JavaScript의 `map()`을 사용하여 배열을 컴포넌트로 렌더링하는 방법
- JavaScript의 `filter()`를 사용하여 특정 컴포넌트만 렌더링하는 방법
- React에서 `Key`가 필요한 때와 이유

## 배열을 데이터로 렌더링하기

- React에서 배열 데이터를 UI로 렌더링하기 위해 **`map()`** 과 **`filter()`** 와 같은 메서드를 자주 활용한다.
- 각 배열 요소를 반복하며 새로운 JSX 요소를 반환하는 방식으로 리스트를 생성한다.
- 예시:
  ```jsx
  const products = ['Apple', 'Banana', 'Orange'];
  const listItems = products.map((product) => <li>{product}</li>);
  ```
- JSX 안에 `{listItems}`를 포함하면 반복된 `<li>`가 렌더링된다.

## 배열의 항목들을 필터링하기

- `filter()` 를 사용해 조건부 렌더링하기
- 특정 조건에 맞는 데이터만 렌더링하고 싶을 때는 `filter()` 를 사용한다.
- 예시:

  ```jsx
  const tasks = [
    { id: 1, title: 'Study React', done: true },
    { id: 2, title: 'Go Running', done: false },
  ];

  const doneTasks = tasks.filter((task) => task.done).map((task) => <li key={task.id}>{task.title}</li>);
  ```

- 조건에 맞는 항목만 UI에 표시할 수 있다.

> **주의하세요!**  
> 화살표 함수는 암시적으로 `=>` 바로 뒤에 식을 반환하기 때문에 `return` 문이 필요하지 않습니다.
>
> ```jsx
> const listItems = chemists.map(
>   (person) => <li>...</li> // 암시적 반환!
> );
> ```
>
> 하지만 `=>` 뒤에 `{` 중괄호가 오는 경우 `return`을 명시적으로 작성해야 합니다!
>
> ```jsx
> const listItems = chemists.map((person) => {
>   // 중괄호
>   return <li>...</li>;
> });
> ```
>
> `=> {` 를 표현하는 화살표 함수를 **“block body”** 를 가지고 있다고 말합니다. 이 함수를 사용하면 한 줄 이상의 코드를 작성할 수 있지만 `return` 문을 반드시 작성해야 합니다. 그렇지 않으면 아무것도 반환되지 않습니다!

> React를 처음 학습하고 사용하던 당시 중괄호와 return 을 제대로 작성하지 않아, 예제 코드와 똑같이 작성했는데도 동작이 되지 않아 헤매고 고민했던 기억이 떠오른다.

## `key`를 사용해서 리스트 항목을 순서대로 유지하기

> **중요합니다!**  
> `map()` 호출 내부의 JSX 엘리먼트에는 항상 key가 필요합니다!

> React에서는 key를 통해 렌더링 시 컴포넌트의 위치와 불변성을 파악하기 때문에 매우 중요하다.

### `key`를 가져오는 곳

- 보통 데이터에 이미 포함된 고유 ID를 `key`로 사용한다.
- 고유 ID가 없을 경우 직접 생성하거나, 데이터 구조를 개선하는 편이 바람직하다.

> map의 index 등을 사용하면, 고유한 key 가 등록되지 않아, UI의 변경 시 혼란이 야기되고 원하는 동작이 이뤄지지 않을 수 있으니 주의하자.

- [`crypto.randomUUID()`](https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID) 또는 [`uuid`](https://www.npmjs.com/package/uuid) 같은 패키지의 도움을 받을 수 있다.

### key 규칙

- key는 형제 컴포넌트 간에서 고유해야 한다.
- 하지만 전체 애플리케이션에서 유일할 필요는 없다.
- index를 key로 쓰는 것은 가급적 피해야 한다. (데이터가 변할 때 예기치 못한 UI 버그 발생 가능)

### React에 key가 필요한 이유는 무엇인가요?

- React는 Virtual DOM에서 리스트를 효율적으로 비교(`diffing`)하기 위해 `key`를 사용한다.
- `key`가 없거나 잘못 설정되면, React는 불필요하게 DOM을 재생성할 수 있고, 성능 저하 및 UI 깜빡임이 발생할 수 있다.
- 올바른 `key`는 React가 컴포넌트를 재사용할 수 있도록 도와 성능 최적화와 올바른 UI 업데이트를 보장한다.

> **주의하세요!**  
> 열에서 항목의 인덱스를 `key`로 사용하고 싶을 수도 있습니다. 실제로 `key`를 전혀 지정하지 않으면 React는 인덱스를 사용합니다.
>
> 하지만 항목이 삽입되거나 삭제하거나 배열의 순서가 바뀌면 시간이 지남에 따라 항목을 렌더링하는 순서가 변경됩니다.
>
> 인덱스를 `key`로 사용하면 종종 미묘하고 혼란스러운 버그가 발생합니다.
>
> 마찬가지로 `key={Math.random()}`처럼 즉석에서 `key`를 생성하지 마세요.
>
> 이렇게 하면 렌더링 간에 `key`가 일치하지 않아 모든 컴포넌트와 DOM이 매번 다시 생성될 수 있습니다. 속도가 느려질 뿐만 아니라 **리스트 항목 내부의 모든 사용자의 입력도 손실**됩니다. 대신 데이터 기반의 **안정적인 ID**를 사용하세요.
>
> 컴포넌트가 `key`를 `prop`으로 받지 않는다는 점에 유의하세요. `key`는 React 자체에서 힌트로만 사용됩니다. 컴포넌트에 ID가 필요하다면 `<Profile key={id} userId={id} />`와 같이 별도의 `prop`으로 전달해야 합니다.

## 요약

- 컴포넌트에서 배열이나 객체와 같은 데이터 구조로 데이터를 이동하는 방법
  - 배열 데이터를 UI로 렌더링할 때는 `map()`을 사용한다.
- JavaScript의 `map()`을 사용하여 유사한 컴포넌트 집합을 생성하는 방법
- JavaScript의 `filter()`를 사용하여 필터링된 항목의 배열을 생성하는 방법
- 특정 조건의 데이터만 렌더링할 때는 `filter()`와 `map()`을 조합한다.
- 컬렉션에서 각 컴포넌트에 `key`를 설정하여 위치나 데이터가 변경되더라도 React가 각 컴포넌트를 추적할 수 있도록 하는 이유와 방법
  - 리스트 항목에는 항상 **고유한 key** 를 부여해야 하며, 보통 데이터의 id를 활용한다.
  - React는 key를 기반으로 **Virtual DOM** 비교를 최적화하여 효율적인 렌더링을 수행한다.

## 인사이트

- React의 렌더링 최적화 관점에서 key의 중요성을 다시 확인했다.

  - React에서는 `key`를 통해 렌더링 시 컴포넌트의 위치와 불변성을 추적하기 때문에 매우 중요하다.

- 리스트 렌더링은 가장 흔히 쓰이는 패턴이지만, 성능과 유지보수성에 직접적인 영향을 주므로 올바른 `key` 관리가 핵심이다.

- `=> {}` 형태의 화살표 함수는 block body로, 반드시 `return`을 작성해야 한다. 초기에 이 부분을 간과해 예제와 동일하게 작성했음에도 동작하지 않아 시행착오를 겪었던 경험이 떠올랐다.
