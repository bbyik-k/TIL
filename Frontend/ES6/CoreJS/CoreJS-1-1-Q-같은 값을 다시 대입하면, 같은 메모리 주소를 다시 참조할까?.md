# [Core JS] 1-같은 값을 다시 대입하면, 같은 메모리 주소를 다시 참조할까?

## 요약

자바스크립트에서 같은 기본형 값을 다시 대입했을 때, **같은 메모리 주소를 다시 참조하는지는 알 수 없고, 실질 개발 구현에서 크게 신경쓸 부분은 아니다.**  
이는 언어 사양이 아닌 **엔진 구현 영역**이기 때문이다.

- 코어자바스크립트에서는 기존에 메모리에 존재하던 값을 새로운 이름의 변수에 할당 시 기존 값에 대한 참조 주소를 할당한다고 말하여, 위 의견과 대비된다.
- 공식 문서 등에서는 언급이 없어, 추상적 개념인지, 실제 동작 방식인지 좀 더 확인이 필요...

## 문제 제기

다음 코드를 보자.

```js
let a = 10;
let b = a;

a = 15;
a = 10;
```

마지막 줄에서 이런 의문이 생긴다.

> a가 다시 10을 대입받을 때,  
> 예전에 사용하던 10의 메모리 주소를 다시 참조할까?  
> 아니면 새로운 10을 만들어 그 주소를 참조할까?

## 핵심 내용

#### 1. 기본형 값은 불변(immutable)이다

MDN과 ECMAScript 사양에 따르면, Number, String 같은 기본형 값은 불변이다.

- 값 자체를 수정할 수 없다
- 변수에 재할당은 가능하지만
- 이는 기존 값을 변경하는 것이 아니라 다른 값을 참조하도록 변경하는 것이다

즉, a = 15는  
“10을 15로 바꾼다”가 아니라  
“a가 15라는 값을 참조하도록 바뀐다”에 가깝다.

#### 2. ECMAScript 사양은 메모리 주소를 규정하지 않는다

**ECMAScript 사양은 다음만을 정의한다.**

- 값의 타입
- 값의 동작 방식
- 비교 연산의 결과

**사양은 절대 다음을 규정하지 않는다.**

- 값이 메모리에 어떻게 저장되는지
- 같은 값이 같은 주소를 쓰는지
- 기존 메모리를 재사용하는지

즉, 메모리 주소는 관찰 불가능한 구현 디테일이며
언어 차원에서 보장되는 개념이 아니다.

#### 3. 엔진 관점에서는 재사용이 가능할 수 있다

엔진 구현 관점에서 보면 다음과 같은 최적화는 매우 합리적이다.

- 숫자 5를 변수 500개에 대입
- 값은 모두 동일하고 불변
- 하나의 값을 두고 주소만 공유하면 메모리 효율이 좋다

실제로 많은 JS 엔진은

- constant pool
- 값 캐싱
- value interning

같은 최적화를 수행할 수 있다.

하지만 이는 어디까지나 엔진의 선택 사항이며 사양적으로 보장된 규칙이 아니다.

#### 4. 그래서 왜 실질 개발 구현에서 크게 신경쓸 부분은 아닌가

개발자는 다음을 절대 구분할 수 없다.

- 기존 10의 주소를 재사용했는지
- 새로운 10을 만들어 참조했는지

```js
a = 10;
b = 10;

a === b; // true
```

주소가 같든 다르든, 결과는 항상 동일하다.  
기본형에서 중요한 것은 주소가 아니라 값의 동일성이다.

#### ETC.

자바스크립트에서는 C, C++과 다르게 변수에 할당된 내용의 메모리 주소를 확인할 수 없다.  
포인터 개념이 적용되지 않는다.

## Check Point

- ECMAScript 사양이 정의하는 범위는 어디까지인가?
- 엔진 구현과 언어 규칙을 구분하고 있는가?

## 언제 문제가 되는가 / 언제 쓰는가

- 기본형과 참조형의 차이를 설명할 때
- 불변성(immutability) 개념을 설명할 때
- React state에서
  - 값 변경과
  - 객체 참조 변경을 구분해야 할 때
- “엔진 최적화”와 “언어 사양”의 경계를 설명할 때

## 정리

같은 기본형 값을 다시 대입했을 때 같은 메모리 주소를 쓰는지는 엔진 측 내부 동작이다.  
자바스크립트에서 중요한 것은 주소가 아니라 값이며, 값의 동일성은 항상 보장된다.
